# ๐ง ุชูุนูู ูุธุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู

## โ๏ธ ููุงุญุธุฉ ูููุฉ

**ูุธุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุนุทู ุญุงููุงู** ูุถูุงู ุงุณุชูุฑุงุฑ ุงููููุน ูุณุฑุนุฉ ุงูุงุณุชุฌุงุจุฉ.

ุงููููุน ูุนูู ุจุดูู ูุงูู:
- โ ุชูุฏูู ุงูุงุณุชุนูุงูุงุช
- โ ููุญุฉ ุชุญูู ุงูููุธููู
- โ ุงูุฑุฏ ุนูู ุงูุงุณุชุนูุงูุงุช
- โ ุญูุธ ุงูุจูุงูุงุช

**ููุท ุงูุฅููููุงุช ุบูุฑ ููุนูุฉ.**

---

## ๐ ููููุฉ ุชูุนูู ูุธุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู

### **ุงูุฎุทูุฉ 1: ุฃุถู ุงููุชุบูุฑุงุช ูู Railway**

1. ุงูุชุญ Railway Dashboard: https://railway.app
2. ุงุฎุชุฑ ุงููุดุฑูุน: `gov-services-portal`
3. ุงุถุบุท `Variables`
4. ุฃุถู ุงููุชุบูุฑุงุช ุงูุซูุงุซุฉ:

```
EMAIL_HOST_USER=albuhairah.test@outlook.com
EMAIL_HOST_PASSWORD=H@mad.95335
DEFAULT_FROM_EMAIL=albuhairah.test@outlook.com
```

### **ุงูุฎุทูุฉ 2: ูู ุงูุชุนููู ูู ุงูููุฏ**

ูู ููู `services/views.py`ุ ูู ุฏุงูุฉ `respond_to_inquiry`:

**ุงุจุญุซ ุนู:**
```python
# ููุงุญุธุฉ: ูุธุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุนุทู ูุคูุชุงู
```

**ูุงุณุชุจุฏู ุงูููุฏ ุจู:**
```python
# ุฅุฑุณุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูููุชุนุงูู
from django.conf import settings

if settings.EMAIL_HOST_USER and settings.EMAIL_HOST_PASSWORD:
    try:
        from threading import Thread
        
        def send_email_async():
            try:
                email_result = email_service.send_inquiry_response(inquiry, response_text)
                if email_result['success']:
                    logger.info(f'ุชู ุฅุฑุณุงู ุจุฑูุฏ ุฅููุชุฑููู ููุงุณุชุนูุงู {inquiry.get_inquiry_id()}')
            except Exception as e:
                logger.error(f'ุฎุทุฃ ูู ุฅุฑุณุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู: {str(e)}')
        
        # ุฅุฑุณุงู ุงูุฅูููู ูู ุฎูููุฉ ุจุฏูู ุงูุชุธุงุฑ
        Thread(target=send_email_async, daemon=True).start()
        logger.info('ุชู ุจุฏุก ุฅุฑุณุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูู ุงูุฎูููุฉ')
    except Exception as e:
        logger.error(f'ุฎุทุฃ ูู ุฅูุดุงุก Thread ููุจุฑูุฏ ุงูุฅููุชุฑููู: {str(e)}')

return JsonResponse({
    'success': True, 
    'message': 'ุชู ุญูุธ ุงูุฑุฏ ุจูุฌุงุญ ูุณูุชู ุฅุฑุณุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู',
    'inquiry_id': inquiry.get_inquiry_id(),
    'email_sent': True
})
```

### **ุงูุฎุทูุฉ 3: ุฑูุน ุงูุชุญุฏูุซ**

```bash
git add .
git commit -m "Enable email system with async sending"
git push
```

---

## ๐ฏ ููุงุฐุง Threadingุ

**ุงููุดููุฉ ุงูุณุงุจูุฉ:**
- Django ููุชุธุฑ ุฅุฑุณุงู ุงูุฅูููู (30 ุซุงููุฉ)
- Worker Timeout!

**ุงูุญู:**
- ุฅุฑุณุงู ุงูุฅูููู ูู **Thread ูููุตู**
- ุงููููุน ูุฑุฏ ููุฑุงู (1 ุซุงููุฉ)
- ุงูุฅูููู ููุฑุณู ูู ุงูุฎูููุฉ

---

## ๐ ุงููุฑู

### **ุจุฏูู Threading (ุงููุดููุฉ ุงููุฏููุฉ):**
```
1. ุญูุธ ุงูุฑุฏ โ 0.1 ุซุงููุฉ
2. ุฅุฑุณุงู ุงูุฅูููู โ 30 ุซุงููุฉ! โ
3. ุงูุฑุฏ ูููุณุชุฎุฏู โ ุจุนุฏ 30 ุซุงููุฉ
```

### **ูุน Threading (ุงูุญู):**
```
1. ุญูุธ ุงูุฑุฏ โ 0.1 ุซุงููุฉ
2. ุจุฏุก Thread ููุฅูููู โ 0.1 ุซุงููุฉ
3. ุงูุฑุฏ ูููุณุชุฎุฏู โ 0.2 ุซุงููุฉ โ
4. ุงูุฅูููู ููุฑุณู ูู ุงูุฎูููุฉ โ ุจุฏูู ุชุฃุซูุฑ
```

---

## โ๏ธ ุชุญุฐูุฑ

**ูุง ุชูุนูู ุงูุฅูููู ูุจู:**
- ุฅุถุงูุฉ ุงููุชุบูุฑุงุช ูู Railway
- ุงูุชุฃูุฏ ูู ุตุญุฉ ุจูุงูุงุช Outlook
- ุงุฎุชุจุงุฑ ุงูุฅุฑุณุงู ูุญููุงู ุฃููุงู

**ูุฅูุง ุณุชุนูุฏ ูุดููุฉ Timeout!**

---

## ๐ก ุจุฏูู ุฃูุถู (ูููุณุชูุจู)

ุงุณุชุฎุฏู **Celery + Redis** ููููุงู ุบูุฑ ุงููุชุฒุงููุฉ:
- ุฃูุซุฑ ุงุญุชุฑุงููุฉ
- ุฃูุถู ูุฅุฏุงุฑุฉ ุงูุทูุงุจูุฑ
- ููุงุณุจ ููุฅูุชุงุฌ

ููู Threading ูุงูู ููุขู!

---

ยฉ 2025 - ุฏููู ุชูุนูู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู

